server:
  port: ${SERVER_PORT:18080}

spring:
  application:
    name: music-webdav
  datasource:
    url: jdbc:mysql://localhost:3306/music_webdav?useUnicode=true&characterEncoding=UTF-8&useSSL=false&serverTimezone=Asia/Shanghai
    username: zhangbiao
    password: zb1998
    driver-class-name: com.mysql.cj.jdbc.Driver
  liquibase:
    enabled: true
    change-log: classpath:db/changelog/db.changelog-master.yaml

mybatis:
  mapper-locations: classpath*:mapper/*.xml
  type-aliases-package: com.example.musicwebdav.infrastructure.persistence.entity
  configuration:
    map-underscore-to-camel-case: true

management:
  endpoints:
    web:
      exposure:
        include: health,info,metrics

logging:
  file:
    path: ./logs
  level:
    root: INFO
    com.example.musicwebdav: INFO

springdoc:
  api-docs:
    path: /v3/api-docs
  swagger-ui:
    path: /swagger-ui.html
    operations-sorter: alpha
    tags-sorter: alpha

app:
  scan:
    batch-size: 300
    parser-thread-count: 6
    max-retry: 3
    retry-backoff-ms: 500
    audio-extensions: mp3,flac,m4a,aac,ogg,wav
    lyric-extensions: lrc,txt
    incremental-cron: "0 0 3 * * ?"
    db-batch-size: 500
    bulk-write-batch-size: 1000
    progress-persist-interval-sec: 120
    metadata-head-bytes: 131072
    metadata-tail-bytes: 128
    directory-list-thread-count: 8
    directory-list-max-in-flight: 96
    directory-process-thread-count: 8
    directory-process-max-in-flight: 96
    incremental-directory-skip-enabled: true
    full-directory-skip-enabled: true
    full-enable-delete-detection: true
    full-enable-dedup: true
    dedup-min-changed-count: 200
    dedup-min-changed-ratio: 0.01
    dedup-always-for-small-library-max-files: 5000
    full-seen-delete-fallback-enabled: false
    incremental-enable-delete-detection: false
    incremental-enable-dedup: false
    small-dir-merge-threshold: 5
    large-dir-warn-threshold: 500
  playlist:
    cleanup-enabled: false
    cleanup-cron: "0 30 4 * * ?"
    cleanup-normalize-order-no: true
  security:
    api-token: dev-token
    encrypt-key: changeit12345678
  webdav:
    connect-timeout-ms: 5000
    socket-timeout-ms: 15000
